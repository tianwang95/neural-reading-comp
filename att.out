Using Theano backend.
Using gpu device 0: GRID K520 (CNMeM is enabled with initial size: 95.0% of memory, cuDNN not available)
____________________________________________________________________________________________________
Layer (type)                       Output Shape        Param #     Connected to                     
====================================================================================================
QueryInput (InputLayer)            (None, 47)          0                                            
____________________________________________________________________________________________________
StoryInput (InputLayer)            (None, 2000)        0                                            
____________________________________________________________________________________________________
embedding_1 (Embedding)            (None, 2000, 100)   8000200     StoryInput[0][0]                 
____________________________________________________________________________________________________
embedding_2 (Embedding)            (None, 47, 100)     8000200     QueryInput[0][0]                 
____________________________________________________________________________________________________
lstm_2 (LSTM)                      (None, 2000, 128)   117248      embedding_1[0][0]                
____________________________________________________________________________________________________
lstm_3 (LSTM)                      (None, 128)         117248      embedding_2[0][0]                
____________________________________________________________________________________________________
lstm_4 (LSTM)                      (None, 128)         117248      embedding_2[0][0]                
____________________________________________________________________________________________________
lstm_1 (LSTM)                      (None, 2000, 128)   117248      embedding_1[0][0]                
____________________________________________________________________________________________________
merge_1 (Merge)                    (None, 256)         0           lstm_3[0][0]                     
                                                                   lstm_4[0][0]                     
____________________________________________________________________________________________________
reverse_1 (Reverse)                (None, 2000, 128)   0           lstm_2[0][0]                     
____________________________________________________________________________________________________
maskedconcat_1 (MaskedConcat)      (None, 2000, 256)   0           lstm_1[0][0]                     
                                                                   reverse_1[0][0]                  
____________________________________________________________________________________________________
repeatvector_1 (RepeatVector)      (None, 2000, 256)   0           merge_1[0][0]                    
____________________________________________________________________________________________________
timedistributed_1 (TimeDistributed)(None, 2000, 256)   65792       maskedconcat_1[0][0]             
____________________________________________________________________________________________________
timedistributed_2 (TimeDistributed)(None, 2000, 256)   65792       repeatvector_1[0][0]             
____________________________________________________________________________________________________
maskedsum_1 (MaskedSum)            (None, 2000, 256)   0           timedistributed_1[0][0]          
                                                                   timedistributed_2[0][0]          
____________________________________________________________________________________________________
activation_1 (Activation)          (None, 2000, 256)   0           maskedsum_1[0][0]                
____________________________________________________________________________________________________
timedistributed_3 (TimeDistributed)(None, 2000, 1)     257         activation_1[0][0]               
____________________________________________________________________________________________________
maskedflatten_1 (MaskedFlatten)    (None, 2000)        0           timedistributed_3[0][0]          
____________________________________________________________________________________________________
activation_2 (Activation)          (None, 2000)        0           maskedflatten_1[0][0]            
____________________________________________________________________________________________________
maskeddot_1 (MaskedDot)            (None, 256)         0           activation_2[0][0]               
                                                                   maskedconcat_1[0][0]             
____________________________________________________________________________________________________
dense_4 (Dense)                    (None, 100)         25700       maskeddot_1[0][0]                
____________________________________________________________________________________________________
dense_5 (Dense)                    (None, 100)         25700       merge_1[0][0]                    
____________________________________________________________________________________________________
merge_2 (Merge)                    (None, 100)         0           dense_4[0][0]                    
                                                                   dense_5[0][0]                    
____________________________________________________________________________________________________
activation_3 (Activation)          (None, 100)         0           merge_2[0][0]                    
____________________________________________________________________________________________________
dense_6 (Dense)                    (None, 596)         60196       activation_3[0][0]               
====================================================================================================
Total params: 16712829
____________________________________________________________________________________________________
None
Starting training
Calling fit generator
Epoch 1/8
/usr/local/lib/python2.7/dist-packages/keras/engine/training.py:1402: UserWarning: Epoch comprised more than `samples_per_epoch` samples, which might affect learning results. Set `samples_per_epoch` correctly to avoid this warning.
  warnings.warn('Epoch comprised more than '
30535s - loss: 2.8545 - acc: 0.4205 - val_loss: 2.0802 - val_acc: 0.5816
Epoch 2/8
30501s - loss: 2.1823 - acc: 0.5833 - val_loss: 1.8759 - val_acc: 0.6207
Epoch 3/8
30536s - loss: 1.9475 - acc: 0.6333 - val_loss: 1.7441 - val_acc: 0.6395
Epoch 4/8
30530s - loss: 1.7464 - acc: 0.6679 - val_loss: 1.7361 - val_acc: 0.6532
Epoch 5/8
30512s - loss: 1.5777 - acc: 0.6999 - val_loss: 1.7668 - val_acc: 0.6514
Epoch 6/8

Using Theano backend.
Using gpu device 0: GRID K520 (CNMeM is enabled with initial size: 95.0% of memory, cuDNN not available)
____________________________________________________________________________________________________
Layer (type)                       Output Shape        Param #     Connected to                     
====================================================================================================
QueryInput (InputLayer)            (None, 47)          0                                            
____________________________________________________________________________________________________
StoryInput (InputLayer)            (None, 2000)        0                                            
____________________________________________________________________________________________________
embedding_1 (Embedding)            (None, 2000, 100)   8000200     StoryInput[0][0]                 
____________________________________________________________________________________________________
embedding_2 (Embedding)            (None, 47, 100)     8000200     QueryInput[0][0]                 
____________________________________________________________________________________________________
lstm_2 (LSTM)                      (None, 2000, 128)   117248      embedding_1[0][0]                
____________________________________________________________________________________________________
lstm_3 (LSTM)                      (None, 128)         117248      embedding_2[0][0]                
____________________________________________________________________________________________________
lstm_4 (LSTM)                      (None, 128)         117248      embedding_2[0][0]                
____________________________________________________________________________________________________
lstm_1 (LSTM)                      (None, 2000, 128)   117248      embedding_1[0][0]                
____________________________________________________________________________________________________
merge_1 (Merge)                    (None, 256)         0           lstm_3[0][0]                     
                                                                   lstm_4[0][0]                     
____________________________________________________________________________________________________
reverse_1 (Reverse)                (None, 2000, 128)   0           lstm_2[0][0]                     
____________________________________________________________________________________________________
maskedconcat_1 (MaskedConcat)      (None, 2000, 256)   0           lstm_1[0][0]                     
                                                                   reverse_1[0][0]                  
____________________________________________________________________________________________________
repeatvector_1 (RepeatVector)      (None, 2000, 256)   0           merge_1[0][0]                    
____________________________________________________________________________________________________
timedistributed_1 (TimeDistributed)(None, 2000, 256)   65792       maskedconcat_1[0][0]             
____________________________________________________________________________________________________
timedistributed_2 (TimeDistributed)(None, 2000, 256)   65792       repeatvector_1[0][0]             
____________________________________________________________________________________________________
maskedsum_1 (MaskedSum)            (None, 2000, 256)   0           timedistributed_1[0][0]          
                                                                   timedistributed_2[0][0]          
____________________________________________________________________________________________________
activation_1 (Activation)          (None, 2000, 256)   0           maskedsum_1[0][0]                
____________________________________________________________________________________________________
timedistributed_3 (TimeDistributed)(None, 2000, 1)     257         activation_1[0][0]               
____________________________________________________________________________________________________
maskedflatten_1 (MaskedFlatten)    (None, 2000)        0           timedistributed_3[0][0]          
____________________________________________________________________________________________________
activation_2 (Activation)          (None, 2000)        0           maskedflatten_1[0][0]            
____________________________________________________________________________________________________
maskeddot_1 (MaskedDot)            (None, 256)         0           activation_2[0][0]               
                                                                   maskedconcat_1[0][0]             
____________________________________________________________________________________________________
dense_4 (Dense)                    (None, 100)         25700       maskeddot_1[0][0]                
____________________________________________________________________________________________________
dense_5 (Dense)                    (None, 100)         25700       merge_1[0][0]                    
____________________________________________________________________________________________________
merge_2 (Merge)                    (None, 100)         0           dense_4[0][0]                    
                                                                   dense_5[0][0]                    
____________________________________________________________________________________________________
activation_3 (Activation)          (None, 100)         0           merge_2[0][0]                    
____________________________________________________________________________________________________
dense_6 (Dense)                    (None, 596)         60196       activation_3[0][0]               
====================================================================================================
Total params: 16712829
____________________________________________________________________________________________________
None
Starting training
Calling fit generator

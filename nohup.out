Using Theano backend.
Using gpu device 0: GRID K520 (CNMeM is disabled, cuDNN not available)
Using Theano backend.
Using gpu device 0: GRID K520 (CNMeM is disabled, cuDNN not available)
____________________________________________________________________________________________________
Layer (type)                       Output Shape        Param #     Connected to                     
====================================================================================================
QueryInput (InputLayer)            (None, 47)          0                                            
____________________________________________________________________________________________________
StoryInput (InputLayer)            (None, 2000)        0                                            
____________________________________________________________________________________________________
embedding_1 (Embedding)            (None, 2000, 100)   1000200     StoryInput[0][0]                 
____________________________________________________________________________________________________
embedding_2 (Embedding)            (None, 47, 100)     1000200     QueryInput[0][0]                 
____________________________________________________________________________________________________
maskedconcat_1 (MaskedConcat)      (None, 2047, 100)   0           embedding_2[0][0]                
                                                                   embedding_1[0][0]                
____________________________________________________________________________________________________
lstm_1 (LSTM)                      (None, 128)         117248      maskedconcat_1[0][0]             
____________________________________________________________________________________________________
lstm_2 (LSTM)                      (None, 128)         117248      maskedconcat_1[0][0]             
____________________________________________________________________________________________________
merge_1 (Merge)                    (None, 256)         0           lstm_1[0][0]                     
                                                                   lstm_2[0][0]                     
____________________________________________________________________________________________________
dense_1 (Dense)                    (None, 596)         153172      merge_1[0][0]                    
====================================================================================================
Total params: 2388068
____________________________________________________________________________________________________
None
Starting training
Calling fit generator
Epoch 1/7

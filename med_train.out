Using Theano backend.
Using gpu device 0: GRID K520 (CNMeM is disabled, cuDNN not available)
____________________________________________________________________________________________________
Layer (type)                       Output Shape        Param #     Connected to                     
====================================================================================================
QueryInput (InputLayer)            (None, 37)          0                                            
____________________________________________________________________________________________________
StoryInput (InputLayer)            (None, 2000)        0                                            
____________________________________________________________________________________________________
embedding_1 (Embedding)            (None, 2000, 100)   7000200     StoryInput[0][0]                 
____________________________________________________________________________________________________
embedding_2 (Embedding)            (None, 37, 100)     7000200     QueryInput[0][0]                 
____________________________________________________________________________________________________
lstm_2 (LSTM)                      (None, 2000, 32)    17024       embedding_1[0][0]                
____________________________________________________________________________________________________
lstm_3 (LSTM)                      (None, 32)          17024       embedding_2[0][0]                
____________________________________________________________________________________________________
lstm_4 (LSTM)                      (None, 32)          17024       embedding_2[0][0]                
____________________________________________________________________________________________________
lstm_1 (LSTM)                      (None, 2000, 32)    17024       embedding_1[0][0]                
____________________________________________________________________________________________________
merge_1 (Merge)                    (None, 64)          0           lstm_3[0][0]                     
                                                                   lstm_4[0][0]                     
____________________________________________________________________________________________________
reverse_1 (Reverse)                (None, 2000, 32)    0           lstm_2[0][0]                     
____________________________________________________________________________________________________
maskedconcat_1 (MaskedConcat)      (None, 2000, 64)    0           lstm_1[0][0]                     
                                                                   reverse_1[0][0]                  
____________________________________________________________________________________________________
repeatvector_1 (RepeatVector)      (None, 2000, 64)    0           merge_1[0][0]                    
____________________________________________________________________________________________________
timedistributed_1 (TimeDistributed)(None, 2000, 64)    4160        maskedconcat_1[0][0]             
____________________________________________________________________________________________________
timedistributed_2 (TimeDistributed)(None, 2000, 64)    4160        repeatvector_1[0][0]             
____________________________________________________________________________________________________
maskedsum_1 (MaskedSum)            (None, 2000, 64)    0           timedistributed_1[0][0]          
                                                                   timedistributed_2[0][0]          
____________________________________________________________________________________________________
activation_1 (Activation)          (None, 2000, 64)    0           maskedsum_1[0][0]                
____________________________________________________________________________________________________
timedistributed_3 (TimeDistributed)(None, 2000, 1)     65          activation_1[0][0]               
____________________________________________________________________________________________________
maskeddot_1 (MaskedDot)            (None, 1, 64)       0/usr/local/lib/python2.7/dist-packages/keras/engine/training.py:1402: UserWarning: Epoch comprised more than `samples_per_epoch` samples, which might affect learning results. Set `samples_per_epoch` correctly to avoid this warning.
  warnings.warn('Epoch comprised more than '
           timedistributed_3[0][0]          
                                                                   maskedconcat_1[0][0]             
____________________________________________________________________________________________________
lambda_1 (Lambda)                  (None, 64)          0           maskeddot_1[0][0]                
____________________________________________________________________________________________________
dense_4 (Dense)                    (None, 100)         6500        lambda_1[0][0]                   
____________________________________________________________________________________________________
dense_5 (Dense)                    (None, 100)         6500        merge_1[0][0]                    
____________________________________________________________________________________________________
merge_2 (Merge)                    (None, 100)         0           dense_4[0][0]                    
                                                                   dense_5[0][0]                    
____________________________________________________________________________________________________
activation_2 (Activation)          (None, 100)         0           merge_2[0][0]                    
____________________________________________________________________________________________________
dense_6 (Dense)                    (None, 484)         48884       activation_2[0][0]               
====================================================================================================
Total params: 14138765
____________________________________________________________________________________________________
None
Starting training
Calling fit generator
Epoch 1/10
2727s - loss: 4.3656 - acc: 0.0806 - val_loss: 4.1204 - val_acc: 0.0577
Epoch 2/10
2730s - loss: 4.4211 - acc: 0.0818 - val_loss: 4.1222 - val_acc: 0.0721
Epoch 3/10
2729s - loss: 4.4560 - acc: 0.0801 - val_loss: 4.1736 - val_acc: 0.0529
Epoch 4/10
2721s - loss: 4.5076 - acc: 0.0815 - val_loss: 4.3095 - val_acc: 0.0601
Epoch 5/10
2729s - loss: 4.5210 - acc: 0.0825 - val_loss: 4.0904 - val_acc: 0.0793
Epoch 6/10
2726s - loss: 4.5377 - acc: 0.0816 - val_loss: 4.2450 - val_acc: 0.0745
Epoch 7/10
2733s - loss: 4.5443 - acc: 0.0792 - val_loss: 4.2253 - val_acc: 0.0553
Epoch 8/10
2734s - loss: 4.5550 - acc: 0.0813 - val_loss: 4.3020 - val_acc: 0.0505
Epoch 9/10
2749s - loss: 4.5711 - acc: 0.0815 - val_loss: 4.2077 - val_acc: 0.0673
Epoch 10/10
2752s - loss: 4.5823 - acc: 0.0816 - val_loss: 4.1976 - val_acc: 0.0649
Training done

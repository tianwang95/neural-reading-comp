Using Theano backend.
Using gpu device 0: GRID K520 (CNMeM is disabled, cuDNN not available)
____________________________________________________________________________________________________
Layer (type)                       Output Shape        Param #     Connected to                     
====================================================================================================
QueryInput (InputLayer)            (None, 37)          0                                            
____________________________________________________________________________________________________
StoryInput (InputLayer)            (None, 2000)        0                                            
____________________________________________________________________________________________________
embedding_1 (Embedding)            (None, 2000, 100)   7000200     StoryInput[0][0]                 
____________________________________________________________________________________________________
embedding_2 (Embedding)            (None, 37, 100)     7000200     QueryInput[0][0]                 
____________________________________________________________________________________________________
maskedconcat_1 (MaskedConcat)      (None, 2037, 100)   0           embedding_2[0][0]                
                                                                   embedding_1[0][0]                
____________________________________________________________________________________________________
gru_1 (GRU)                        (None, 128)         87936       maskedconcat_1[0][0]             
____________________________________________________________________________________________________
gru_2 (GRU)                        (None, 128)         87936       maskedconcat_1[0][0]             
____________________________________________________________________________________________________
merge_1 (Merge)                    (None, 256)         0           gru_1[0][0]                      
                                                                   gru_2[0][0]                      
____________________________________________________________________________________________________
dense_1 (Dense)                    (None, 484)         124388      merge_1[0][0]                    
====================================================================================================
Total params: 14300660
____________________________________________________________________________________________________
None
Starting training
Calling fit generator
Epoch 1/20
/usr/local/lib/python2.7/dist-packages/keras/engine/training.py:1402: UserWarning: Epoch comprised more than `samples_per_epoch` samples, which might affect learning results. Set `samples_per_epoch` correctly to avoid this warning.
  warnings.warn('Epoch comprised more than '
8848s - loss: 4.0850 - acc: 0.0887 - val_loss: 3.7868 - val_acc: 0.1178
Epoch 2/20
8853s - loss: 3.6850 - acc: 0.2128 - val_loss: 3.6984 - val_acc: 0.2260
Epoch 3/20
